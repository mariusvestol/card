import requests
import pandas as pd
from io import BytesIO

cookies = {
    'rtFa': 'ug2KWCngSNAzmVu8EsSCbxjCS4m4CrMDX1MgzIe3tosmNGU0ZjZhNWMtYTcwNi00NzM4LTgzY2UtMmNmNTdiZWJlOGE1IzEzMzkwOTI5MzUzMjA3MjU1MiNjYzMwOWJhMS05MDlhLWMwMDAtYTAzZC03N2IyMTAwMThlMGIjbWFyaXVzLnZlc3RvbCU0MGFuZW9tb2JpbGl0eS5jb20jMTg5NDgzI3AyOEl5ZnRKUGhoMnZ5UW1BY3ZmUkdMUkY1NCNITXhVSXVzR1pTQ2F3eGdrSWRVSms4SURrOXedNDr4A+06HGssMBC5ZxfVgm35ZdRKc4cq1rZmgEA9XFDfx3urc4pwjk7Tb4w39z4O0Xwnyt9LYME4wdij66lM6GXDkujyJU9xYd8XxaqPX/0sIMCiRNYiCD0hZWmOci7c1FPPA/h4htj4ZaHHSh3upMwh9Y0gcUaA7eKZbtptZYYmQ0mwP1Sx4M/H3pCdtl+qx4tOCb43HdiZZMTAetv//V4jfb1fVGPKJm/wzuBhTLQ9h+NxfMqf2rJKBhjj7TC84/CZ4094iHZDZO1/llAabVdooGJXVWda1fcqplo5VNmdC8+t5BGeqOtp6ZygdpQ5SNJG1CGTBoqj1NGBNH9D3QAAAA==',
    'FedAuth': '77u/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48U1A+VjE0LDBoLmZ8bWVtYmVyc2hpcHwxMDAzMjAwNDZmNTM2ZjQyQGxpdmUuY29tLDAjLmZ8bWVtYmVyc2hpcHxtYXJpdXMudmVzdG9sQGFuZW9tb2JpbGl0eS5jb20sMTMzOTA4NTU5OTQwMDAwMDAwLDEzMzg3Mjk5MDQ4MDAwMDAwMCwxMzM5MTM2MTM1MzE5MTU4NTksMTI5LjI0MS4yMzYuMjQ3LDMsNGU0ZjZhNWMtYTcwNi00NzM4LTgzY2UtMmNmNTdiZWJlOGE1LCwwMDRjZWY2OS1hYjNhLWFkOWYtN2JmNC03ODZmNDM4MGQzNGMsY2MzMDliYTEtOTA5YS1jMDAwLWEwM2QtNzdiMjEwMDE4ZTBiLGNjMzA5YmExLTkwOWEtYzAwMC1hMDNkLTc3YjIxMDAxOGUwYiwsMCwxMzM5MTAxNTc1MzE2MDM0NjcsMTMzOTExODg1NTMxNjAzNDY3LCwsZXlKNGJYTmZZMk1pT2lKYlhDSkRVREZjSWwwaUxDSjRiWE5mYzNOdElqb2lNU0lzSW5CeVpXWmxjbkpsWkY5MWMyVnlibUZ0WlNJNkltMWhjbWwxY3k1MlpYTjBiMnhBWVc1bGIyMXZZbWxzYVhSNUxtTnZiU0lzSW5WMGFTSTZJbkZRYVRJdExVZHdRV3RYVkdWc2VtcHdVM055UVVFaWZRPT0sMjY1MDQ2Nzc0Mzk5OTk5OTk5OSwxMzM5MDkyOTM1MjAwMDAwMDAsNGMzZGFjNGQtOGEwOS00N2JhLWFjODgtMDFiMGJkZGE3YjJhLCwsLCwsMTE1MjkyMTUwNDYwNjg0Njk3NiwsMTg5NDgzLGQ3V19lbmZqWjMyVl9SdXI5aVJ3T1A1RThjOCx6TlgyRGVjVVk2UkhKRlVrcV9VS3NLMTcxM0EsYkdNVjZoZHNoN0pvQzF5OXA2L3pzSXpLc2xtUFcyOS9iSVhpUGJYTlFBeVlrM0NTSmxxRjVOMGZ3L0RnNVh2RVlDQXBKTGE3UW93ZWxjbE5MdlNEdWhpRHpVWnVoUmx3a0dadEdkSHZPSzlEalhvamhBSHZSUEg2RzZJS055dThxVThVWklvcGIwRFZvYzJrV1gzRXZ1RmdxUUZLa1QwNGxqTVR5enl5U2RFeEtKWHlmNTNkQTVpeTFZYUUzVkxJemQxWUFQcWFaRXEzZEg0UHgyeng2My80OGFVV0M3aTFQN1pMQUVrdUNEdm5BU2EyUkVSMWgwdytKc0QySW5lbFRvbUpYQ1ZtNWpkQ2J4US9aODJIMEU2VHh4VHU0RTFJT2FMWDVtY3YrYWpFSjdPdGZSaHVDdlJ3STFtc1ZTMEFDNHdoa21QblpQREVjWlJBaTE5U3F3PT08L1NQPg==',
}

session = requests.Session()
session.cookies.update(cookies)

# Bruk session til å gjøre forespørsler
response = session.get("https://aneomobility.sharepoint.com/sites/AneoMobility/Shared%20Documents/Kundesenter/Ressursplan%20KS.xlsx")

with open("Ressursplan_KS.xlsx", "wb") as f:
    f.write(response.content)
print("Filen er lagret.")

# Antar at response.content inneholder Excel-filens innhold
excel_data = BytesIO(response.content)

# Les innholdet fra excel-filen til en pandas DataFrame med openpyxl engine
df = pd.read_excel(excel_data, engine='openpyxl')

# Nå kan du filtrere radene hvor celle C har verdien "Marius V"
filtered_df = df[df['C'] == 'Marius V']

# Skriv ut de filtrerte radene
print(filtered_df)

"""
cookies = {
    'rtFa': 'ug2KWCngSNAzmVu8EsSCbxjCS4m4CrMDX1MgzIe3tosmNGU0ZjZhNWMtYTcwNi00NzM4LTgzY2UtMmNmNTdiZWJlOGE1IzEzMzkwOTI5MzUzMjA3MjU1MiNjYzMwOWJhMS05MDlhLWMwMDAtYTAzZC03N2IyMTAwMThlMGIjbWFyaXVzLnZlc3RvbCU0MGFuZW9tb2JpbGl0eS5jb20jMTg5NDgzI3AyOEl5ZnRKUGhoMnZ5UW1BY3ZmUkdMUkY1NCNITXhVSXVzR1pTQ2F3eGdrSWRVSms4SURrOXedNDr4A+06HGssMBC5ZxfVgm35ZdRKc4cq1rZmgEA9XFDfx3urc4pwjk7Tb4w39z4O0Xwnyt9LYME4wdij66lM6GXDkujyJU9xYd8XxaqPX/0sIMCiRNYiCD0hZWmOci7c1FPPA/h4htj4ZaHHSh3upMwh9Y0gcUaA7eKZbtptZYYmQ0mwP1Sx4M/H3pCdtl+qx4tOCb43HdiZZMTAetv//V4jfb1fVGPKJm/wzuBhTLQ9h+NxfMqf2rJKBhjj7TC84/CZ4094iHZDZO1/llAabVdooGJXVWda1fcqplo5VNmdC8+t5BGeqOtp6ZygdpQ5SNJG1CGTBoqj1NGBNH9D3QAAAA==',
    'FedAuth': '77u/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48U1A+VjE0LDBoLmZ8bWVtYmVyc2hpcHwxMDAzMjAwNDZmNTM2ZjQyQGxpdmUuY29tLDAjLmZ8bWVtYmVyc2hpcHxtYXJpdXMudmVzdG9sQGFuZW9tb2JpbGl0eS5jb20sMTMzOTA4NTU5OTQwMDAwMDAwLDEzMzg3Mjk5MDQ4MDAwMDAwMCwxMzM5MTM2MTM1MzE5MTU4NTksMTI5LjI0MS4yMzYuMjQ3LDMsNGU0ZjZhNWMtYTcwNi00NzM4LTgzY2UtMmNmNTdiZWJlOGE1LCwwMDRjZWY2OS1hYjNhLWFkOWYtN2JmNC03ODZmNDM4MGQzNGMsY2MzMDliYTEtOTA5YS1jMDAwLWEwM2QtNzdiMjEwMDE4ZTBiLGNjMzA5YmExLTkwOWEtYzAwMC1hMDNkLTc3YjIxMDAxOGUwYiwsMCwxMzM5MTAxNTc1MzE2MDM0NjcsMTMzOTExODg1NTMxNjAzNDY3LCwsZXlKNGJYTmZZMk1pT2lKYlhDSkRVREZjSWwwaUxDSjRiWE5mYzNOdElqb2lNU0lzSW5CeVpXWmxjbkpsWkY5MWMyVnlibUZ0WlNJNkltMWhjbWwxY3k1MlpYTjBiMnhBWVc1bGIyMXZZbWxzYVhSNUxtTnZiU0lzSW5WMGFTSTZJbkZRYVRJdExVZHdRV3RYVkdWc2VtcHdVM055UVVFaWZRPT0sMjY1MDQ2Nzc0Mzk5OTk5OTk5OSwxMzM5MDkyOTM1MjAwMDAwMDAsNGMzZGFjNGQtOGEwOS00N2JhLWFjODgtMDFiMGJkZGE3YjJhLCwsLCwsMTE1MjkyMTUwNDYwNjg0Njk3NiwsMTg5NDgzLGQ3V19lbmZqWjMyVl9SdXI5aVJ3T1A1RThjOCx6TlgyRGVjVVk2UkhKRlVrcV9VS3NLMTcxM0EsYkdNVjZoZHNoN0pvQzF5OXA2L3pzSXpLc2xtUFcyOS9iSVhpUGJYTlFBeVlrM0NTSmxxRjVOMGZ3L0RnNVh2RVlDQXBKTGE3UW93ZWxjbE5MdlNEdWhpRHpVWnVoUmx3a0dadEdkSHZPSzlEalhvamhBSHZSUEg2RzZJS055dThxVThVWklvcGIwRFZvYzJrV1gzRXZ1RmdxUUZLa1QwNGxqTVR5enl5U2RFeEtKWHlmNTNkQTVpeTFZYUUzVkxJemQxWUFQcWFaRXEzZEg0UHgyeng2My80OGFVV0M3aTFQN1pMQUVrdUNEdm5BU2EyUkVSMWgwdytKc0QySW5lbFRvbUpYQ1ZtNWpkQ2J4US9aODJIMEU2VHh4VHU0RTFJT2FMWDVtY3YrYWpFSjdPdGZSaHVDdlJ3STFtc1ZTMEFDNHdoa21QblpQREVjWlJBaTE5U3F3PT08L1NQPg==',
}"""


#https://aneomobility.sharepoint.com/sites/AneoMobility/Shared%20Documents/Kundesenter/Ressursplan%20KS.xlsx